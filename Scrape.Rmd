---
title: "Scrape"
author: "Siri Sagedahl"
date: "2024-05-04"
output: html_document
---

```{r}
library(tidyverse)
library(stringr)
library(rvest)
library(httr)
library(janitor)
```


```{r}
robotstxt::paths_allowed("https://www.equaldex.com/equality-index")

robotstxt::paths_allowed("https://stolaf.studioabroad.com/index.cfm?FuseAction=Programs.ListAll&type=1")
```

```{r}
equaldex <- read_html("https://www.equaldex.com/equality-index")

tables2 <- html_nodes(equaldex, css = "table") 

html_table(tables2, header = TRUE, fill = TRUE)

equality <- html_table(tables2, header = TRUE, fill = TRUE)[[5]]
```


```{r}
studyabroad <- read_html("https://stolaf.studioabroad.com/index.cfm?FuseAction=Programs.ListAll&type=1")

tables3 <- html_nodes(studyabroad, css = "table") 

html_table(tables3, header = TRUE, fill = TRUE)

studyabroad <- html_table(tables3, header = TRUE, fill = TRUE)[[1]]
```

```{r}
#cleaning

studyabroad$City <- str_replace_all(studyabroad$City, "(\t){1,}", "")

studyabroad$Country <- str_replace_all(studyabroad$Country, "(\t){1,}", "")
```

```{r}
equality <- clean_names(equality)
equality$public_opinion_index <- str_replace_all(equality$public_opinion_index, "Ã¢.", "NA")
equality$country <- str_remove_all(equality$country, "[\\d\\d. ]")
```

```{r}
studyabroad <- clean_names(studyabroad)
```


```{r}
studyabroad <- separate_rows(studyabroad, country, sep = "\n")
```

```{r}
studyabroad <- studyabroad |>
  mutate(save_share = ifelse(save_share == "", FALSE, TRUE)) |>
  rename(interim = save_share)
```

