---
title: "Equality & Study Abroad"
runtime: shiny
output: 
  flexdashboard::flex_dashboard:
    theme: yeti
---

```{r global, include=FALSE, message=FALSE}
library(tidyverse)
library(knitr)
studyabroad <- read_csv("studyabroad.csv")
```

About
==========================

Column {data-width = 400}
-------------------------

#### Authors

Siri Sagedahl and Cole Monson

#### Background Information

This past January, Cole and Siri went on a study abroad program to Budapest, Hungary. It was both of our first times studying abroad and it made us realize the complexities of traveling to another location for extended periods of time. Despite only living in Budapest for a month, the stark cultural differences were apparent in our daily lives. One of these differences between Minnesota and Budapest was the acceptance of LGBTQ+ identifying people. The conservative government limits general LGBTQ+ rights and the solitary social culture is far less accepting than the United States. As an LGBTQ+ identifying person, Siri had to look into this culture prior to traveling to Hungary. 

This project is a way to make this research more accessible to LGBTQ+ students looking to study abroad. Knowing how the new culture you're being immersed into sees your identity is very important for students' overall well being while away. This app connects programs to acceptance indecies of accpetance levels, allowing students to explore the country's culture prior to committing to a program.

#### Data Sources

+ Equality indices from [Equaldex](https://www.equaldex.com/equality-index) 
+ Study abroad information from [St. Olaf Smith Center](https://stolaf.studioabroad.com/index.cfm?FuseAction=Programs.SimpleSearch)


Column {data-width = 200}
-------------------------

```{r  fig.width = 6.5, fig.height = 5}
include_graphics("IMG_3703.jpeg") 
```


Categorical Predictors
==========================

Inputs {.sidebar}
-------------------------
```{r, echo=FALSE}
inputPanel(
      selectInput(inputId = "categ",
                  label = h3("Boxplot categories"),
                  choices = c("Lot Shape" = "LotShape", 
                              "Land Slope" = "LandSlope", 
                              "House Style" = "HouseStyle", 
                              "Foundation" = "Foundation", 
                              "Paved Drive" = "PavedDrive"),
                  selected = "Foundation"),
      selectInput(inputId = "shape",
                  label = h3("Lot shape"),
                  choices = c("Reg" = "Reg", 
                              "IR1" = "IR1"),
                  selected = "Foundation"),
     numericInput(inputId = "cutoff", 
                   label = h3("Exclude prices above:"), 
                   value = 500000)
)
```


Column 
-------------------------

```{r, echo = FALSE}
renderPlot({
    ames %>%
      filter(LotShape == input$shape) %>%
      filter(SalePrice < input$cutoff) %>%
      select(input$categ, "SalePrice") %>%
    ggplot(aes(x = .data[[input$categ]], y = SalePrice)) +
      geom_boxplot() +
      coord_flip() 
})
```

Column 
-------------------------

```{r, echo = FALSE}
renderPlot({
    ames %>% as_tibble() %>%
      mutate(x = ames[[input$categ]]) %>%
      group_by(x) %>%
      summarise(meanprice = mean(SalePrice, na.rm = TRUE)) %>%
      mutate(x = fct_reorder(x, meanprice)) %>%
    ggplot(aes(x = x, y = meanprice)) +
      geom_bar(stat = "identity") +
      labs(x = input$categ)
})
```

Numerical Predictors
==========================

<center>

```{r, echo=FALSE}
inputPanel(
      selectInput(inputId = "numer",
                  label = h3("Numeric predictors"),
                  choices = c("Lot Area" = "LotArea", 
                              "Overall Quality" = "OverallQual", 
                              "Year Built" = "YearBuilt", 
                              "Above Ground Sqft" = "SqFtAboveGrd", 
                              "Bedrooms" = "Bedrooms"),
                  selected = "Above Ground Sqft"),
      numericInput(inputId = "cutoff2", 
                   label = h3("Exclude prices above:"), 
                   value = 500000)
)

renderPlot({
    ames %>%
      filter(SalePrice < input$cutoff2) %>%
      select(input$numer, "SalePrice") %>%
    ggplot(aes(x = .data[[input$numer]], y = SalePrice)) +
      geom_point() +
      geom_smooth() 
})
```



